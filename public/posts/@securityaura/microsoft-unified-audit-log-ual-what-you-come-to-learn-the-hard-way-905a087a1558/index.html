<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  <title>Microsoft Unified Audit Log (UAL): What You Come To Learn The Hard Way &middot; SecurityAura Blog</title>
    <meta name="title" content="Microsoft Unified Audit Log (UAL): What You Come To Learn The Hard Way &middot; SecurityAura Blog">

  
  <meta name="description" content="Disclaimer">
  
  
  
  <link rel="canonical" href="http://192.168.50.40:1313/posts/@securityaura/microsoft-unified-audit-log-ual-what-you-come-to-learn-the-hard-way-905a087a1558/">
  
  
  
  
  
  
  
  
  
  
    
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.d7672814413dccdcf76c504d9b0ebb8d0f964dbe6b30a3d4b25b15809a94c2eb732d99898aded2009aacdd1fa8b17cea1369fd81560790cd355aee00bbd142fd.css"
    integrity="sha512-12coFEE9zNz3bFBNmw67jQ&#43;WTb5rMKPUslsVgJqUwutzLZmJit7SAJqs3R&#43;osXzqE2n9gVYHkM01Wu4Au9FC/Q==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
    
    
    
  
  
  
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.a187118b41a60744310065c567365de85730c8495301d0ebae41810cc6f7a47432b1de7d4f3b11338959f1ac50c266be6b4b73acf6bf770016eb59b602cc1aa0.js"
      integrity="sha512-oYcRi0GmB0QxAGXFZzZd6FcwyElTAdDrrkGBDMb3pHQysd59TzsRM4lZ8axQwma&#43;a0tzrPa/dwAW61m2AswaoA=="
      data-copy="Copy"
      data-copied="Copied"></script>
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  
  
  
  
  

  
  <meta property="og:url" content="http://192.168.50.40:1313/posts/@securityaura/microsoft-unified-audit-log-ual-what-you-come-to-learn-the-hard-way-905a087a1558/">
  <meta property="og:site_name" content="SecurityAura Blog">
  <meta property="og:title" content="Microsoft Unified Audit Log (UAL): What You Come To Learn The Hard Way">
  <meta property="og:description" content="Disclaimer">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-17T03:58:02+00:00">
    <meta property="article:modified_time" content="2024-12-17T03:58:02+00:00">
    <meta property="og:image" content="http://192.168.50.40:1313/posts/@securityaura/microsoft-unified-audit-log-ual-what-you-come-to-learn-the-hard-way-905a087a1558/featured.png">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://192.168.50.40:1313/posts/@securityaura/microsoft-unified-audit-log-ual-what-you-come-to-learn-the-hard-way-905a087a1558/featured.png">
  <meta name="twitter:title" content="Microsoft Unified Audit Log (UAL): What You Come To Learn The Hard Way">
  <meta name="twitter:description" content="Disclaimer">
<meta name="twitter:image" content="http://192.168.50.40:1313/posts/@securityaura/microsoft-unified-audit-log-ual-what-you-come-to-learn-the-hard-way-905a087a1558/featured.png">
    <meta property="og:image" content="http://192.168.50.40:1313/posts/@securityaura/microsoft-unified-audit-log-ual-what-you-come-to-learn-the-hard-way-905a087a1558/featured.png">
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Microsoft Unified Audit Log (UAL): What You Come To Learn The Hard Way",
    "headline": "Microsoft Unified Audit Log (UAL): What You Come To Learn The Hard Way",
    "description": "Disclaimer",
    
    "inLanguage": "en",
    "url" : "http:\/\/192.168.50.40:1313\/posts\/@securityaura\/microsoft-unified-audit-log-ual-what-you-come-to-learn-the-hard-way-905a087a1558\/",
    "author" : {
      "@type": "Person",
      "name": "SecurityAura"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-12-17T03:58:02\u002b00:00",
    "datePublished": "2024-12-17T03:58:02\u002b00:00",
    
    "dateModified": "2024-12-17T03:58:02\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "1956"
  }]
  </script>



  
  
    <meta name="author" content="SecurityAura">
  
  
    
      
        
          <link href="https://x.com/SecurityAura" rel="me">
        
      
    
      
        
          <link href="https://bsky.app/profile/securityaura.bsky.social" rel="me">
        
      
    
      
        
          <link href="https://infosec.exchange/@SecurityAura" rel="me">
        
      
    
      
        
          <link href="https://github.com/SecurityAura" rel="me">
        
      
    
      
        
          <link href="https://medium.com/@securityaura" rel="me">
        
      
    
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>























  
  





  
  

  
  

  
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
  
  
    
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">
          SecurityAura Blog
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/about-me/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="About Me">
    About Me
  </p>
</a>



      
        
  <a
  href="/posts/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Posts">
    Posts
  </p>
</a>



      
        
  <a
  href=""
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="">
    
  </p>
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/about-me/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="About Me">
      About Me
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Posts">
      Posts
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="">
      
    </p>
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Microsoft Unified Audit Log (UAL): What You Come To Learn The Hard Way
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-12-17T03:58:02&#43;00:00">17 December 2024</time><span class="px-2 text-primary-500">&middot;</span><span>1956 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">10 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  

  

  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
          <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#disclaimer">Disclaimer</a></li>
        <li><a href="#premise">Premise</a></li>
        <li><a href="#so-many-ip-addresses-but-notalways">So Many IP Addresses (But Not Always)</a></li>
        <li><a href="#not-all-ip-addresses-areequal">Not All IP Addresses Are Equal</a></li>
        <li><a href="#its-always-microsoft">It’s Always Microsoft</a></li>
        <li><a href="#the-inconsistency-isreal">The Inconsistency is Real</a></li>
        <li><a href="#correlation-goes-a-longway">Correlation Goes A Long Way</a></li>
        <li><a href="#okay-ual-is-crap-nowwhat">Okay, UAL is Crap. Now What?</a></li>
        <li><a href="#rant">/Rant</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#disclaimer">Disclaimer</a></li>
        <li><a href="#premise">Premise</a></li>
        <li><a href="#so-many-ip-addresses-but-notalways">So Many IP Addresses (But Not Always)</a></li>
        <li><a href="#not-all-ip-addresses-areequal">Not All IP Addresses Are Equal</a></li>
        <li><a href="#its-always-microsoft">It’s Always Microsoft</a></li>
        <li><a href="#the-inconsistency-isreal">The Inconsistency is Real</a></li>
        <li><a href="#correlation-goes-a-longway">Correlation Goes A Long Way</a></li>
        <li><a href="#okay-ual-is-crap-nowwhat">Okay, UAL is Crap. Now What?</a></li>
        <li><a href="#rant">/Rant</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h3 class="relative group">Disclaimer 
    <div id="disclaimer" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#disclaimer" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Obligatory disclaimer that English is not my first language and I wrote this blog post in one go with no QA (re-reading) afterwards. So if you spot any kind of mistakes, typos, etc. (HI <a
  href="https://medium.com/u/ded10e366d15"
    target="_blank"
  >Ann Fam</a>!) feel free to DM me on Twitter (or X as it’s called now).</p>
<p>Also, the kind of BECs I’m talking about here are your run-of-the-mill BECs that ended up in financial fraud of some kind, or the threat actor leveraging his access to send phishing emails (internally and externally). Not really dealing with APTs here.</p>

<h3 class="relative group">Premise 
    <div id="premise" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#premise" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>The idea, or content if I can say, for this blog post mostly comes from a tweet <a
  href="https://medium.com/u/4b5e6b2d7e69"
    target="_blank"
  >EricaZelic</a> posted earlier today.</p>
<p>Since I had just spent the whole day going through two (2) huge UAL for two (2) Business Email Compromise (BEC) I had been working on, and took some time to update my (numerous) parsing and analysis scripts, the ̶r̶a̶g̶e̶ insights were still fresh in my mind.</p>
<p>Therefore, this blog post will highlight a few things you should know about UAL and in some situations, how you can deal with them.</p>

<h3 class="relative group">So Many IP Addresses (But Not Always) 
    <div id="so-many-ip-addresses-but-notalways" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#so-many-ip-addresses-but-notalways" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>If you’re like me and like to tell clients that in the UAL, every event is linked to an IP address so that’s how you can identify events generated by an authorized third-party, well, welcome to the liar’s circle.</p>
<p>The truth is that not every event in the UAL has an IP address associated with it. And you can see this in two (2) ways: some events simply do not have a field holding IP address information, while some do have a field for ClientIP (or else) but it’s simply empty (you can’t imagine how hard I’m holding back writing this line).</p>
<p>And for these events that have an IP address, you can actually have multiple JSON fields representing that IP. The most common ones are: ClientIP, ClientIPAddress and ActorIPAddress. So depending on the Operation type, the field holding the IP address information may change. More information about this can be found in the Microsoft Learn page for the Office 365 Management Activity API Schema:</p>
<p><a
  href="https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema"title="https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema"
    target="_blank"
  ><strong>Office 365 Management Activity API schema</strong><br>
_The Office 365 Management Activity API schema is provided as a data service in two layers - Common schema and…_learn.microsoft.com</a><a
  href="https://learn.microsoft.com/en-us/office/office-365-management-api/office-365-management-activity-api-schema"
    target="_blank"
  ></a></p>

<h3 class="relative group">Not All IP Addresses Are Equal 
    <div id="not-all-ip-addresses-areequal" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#not-all-ip-addresses-areequal" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>From there, if you’re lucky enough to have a UAL with load of IP addresses, you’ll face your 2nd hurdle: their variety. Within a full UAL for a user (may it be for 30, 60, 90 days, etc.) you can get the following kind of IPs for all sort of Operations:</p>
<ul>
<li>Local (RFC1918) IPv4</li>
<li>Localhost/Loopback IPv6 (::1)</li>
<li>Link-Local IPv6 (fe80::)</li>
<li>IPv4 (e.g.: 20.30.40\[.\]50)</li>
<li>IPv6 (you all know what an IPv6 looks like)</li>
<li>IPv4 with port (e.g.: 20.30.40\[.\]50:12345)</li>
<li>IPv4 with the last octet missing (e.g: 20.30.40.x)</li>
</ul>
<p>So right off the bat, remember that statement about being able to identify events from an unauthorized party by looking for events with “sus” IP addresses? Good luck with that.</p>
<p>But anyway, you have IP addresses, great! They are just random numbers that means absolutely nothing until you enrich them obviously. Only from there would you be able to determine if they’re truly “sus” or not (and even there, more about this later in this post).</p>
<p>So fire up your favorite IP enrichment API and pass it that list of unique IP addresses to get the information you need. Spur.us is a GREAT product when it comes to identifying IP addresses associated with anonymization solutions and/or products (read: VPN). Or you can also flag them based on ASNs that are known to have a bad reputation, are abused by threat actors and/or are just outright known to be associated with VPN providers. Something like IPinfo.io with their free tier can definitely assist with that.</p>

<h3 class="relative group">It’s Always Microsoft 
    <div id="its-always-microsoft" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#its-always-microsoft" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Another issue you’re going to face when identifying these IP addresses is trying to identify the ones that are related to Microsoft-related services, may it be Office or Azure. Luckily for us, Microsoft has two (2) files you can use to help see if an IP is part of a Office and/or Azure IP range.</p>
<p>The Microsoft Public IP Space:</p>
<p><a
  href="https://www.microsoft.com/en-us/download/details.aspx?id=53602"
    target="_blank"
  >https://www.microsoft.com/en-us/download/details.aspx?id=53602</a></p>
<p>The Microsoft Azure IP Ranges and Service Tags — Public Cloud:</p>
<p><a
  href="https://www.microsoft.com/en-us/download/details.aspx?id=56519"
    target="_blank"
  >https://www.microsoft.com/en-us/download/details.aspx?id=56519</a></p>
<p>The first one is a CSV file and the second one a JSON because … Because? Yeah, why? At this point I don’t care, all you need to know is that whatever automation you’re planning on building to handle the lookup, you’ll have to handle both CSV and JSON files.</p>
<p>Now that you identified which IPs are associated with Microsoft and marked the UAL events associated with them as such, you think you’re good to go, right? Do you really think I would go through the trouble of writing a blog post at 10 PM on a Monday night if it was the case? Of course not. After doing this exercise, you’ll realize that Microsoft has a lot, and by that I mean, A LOT, of IP addresses that are undocumented (as I call them). By that I mean they aren’t IP addresses that fit in any of the prefixes from the two (2) previous files. So you’re basically back to IP address enrichment (OrgName, ASN, etc.) to try and filter out these remaining offenders. Because nothing is ever easy with Microsoft.</p>

<h3 class="relative group">The Inconsistency is Real 
    <div id="the-inconsistency-isreal" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#the-inconsistency-isreal" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Now that you’ve identified all your IP addresses and flagged suspicious and/or malicious events, you think that all is well that ends well, right? Well, not quite.</p>
<p>Now you basically need to dig into these UAL events one-by-one (literally, or not, depending on which road you go down) to try and identify what exactly happened and what are the implications.</p>
<p>To do so, you need to dig into the AuditData field (if you exported the UAL as a CSV) which is just a big JSON blob with all the information related to an event. You’ll start dissecting some events and notice interesting fields such as ApplicationId, SessionId, ClientAppId…? AppAccessContentAPIId? AppAccessContentClientAppId? Why do some of these fields feel like they’re the same, but with a different name?</p>
<p>Because this is exactly what this is. At least, based on my research into two (2) UAL files today which I finally took the time to do. Some of these fields hold the exact same kind of information/value but depending on the Operation type, the fields that are present, used and populated will differ. From what I can see at the very least:</p>
<ul>
<li>ApplicationId, ClientAppId and AppAccessContextClientAppId will either have one of these field populated, but if more than one is, it’ll be the same value</li>
<li>AppAccessContextAADSessionId and SessionId don’t seem to have an overlap, it’s either one or the other. But the values you get basically covers the “same” sessions. So for instance, you can have events where the AppAccessContextAADSessionId is set and others where that value is in the SessionId field</li>
</ul>
<p>At some point (read: when I stop being lazy), I’ll post a small comparation table into these different Operation types and fields on my Github so you can see for yourself. The result isn’t pretty obviously.</p>

<h3 class="relative group">Correlation Goes A Long Way 
    <div id="correlation-goes-a-longway" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#correlation-goes-a-longway" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Now, remember that statement where if you filter out events from Microsoft IPs, you’re “good-to-go”? Well, I’m going to confuse you even more.</p>
<p>What I often see in my BECs is the threat actor logging in to the account through either OfficeHome (which is portal</p>
\[.\]<p>office</p>
\[.\]<p>com) or Office 365 Exchange Online (which should be outlook</p>
\[.\]<p>office</p>
\[.\]<p>com). In instances where the AppId points to OfficeHome, you may also get FilePreviewed and FileAccessed events. Which, from what I remember in my previous testing, would be because of these “last modified”, “last accessed”, etc. files that are displayed in your Office portal when you log in. You’ll notice that these events are actually associated with Microsoft-related IPs. However, if you look at the CreationDate for those, and the User-Agent, you can actually associate them with UserLoggedIn events for the OfficeHome AppId.</p>
<p>So a good strategy in identifying those, because I should at least give some tips and tricks here and not just baseless hate, is having your filters set for the AzureActiveDirectoryStsLogon record types (UserLoggedIn is part of it) and the SharePointFileOperation (which FilePreviewed and FileAccessed are part of). From there, order the events in a chronological order and if you see any login events with the same CreationDate as FilePreviewed and FileAccessed events, confirm that the User-Agent field is the same for these 2–3 Operation type of events. And if they are, you can cluster these events in the batch generated by the threat actor.</p>
<p>And some obviously bad events, such as the threat actor “installing” (read: consenting) to an application in Azure (e.g.: eM Client, PERFECTDATA, etc.), actually comes from Microsoft-related IP addresses, when they have one. One of the UAL I looked at today just don’t have any IP address associated with these. So if your analysis is based on event identification through IP address enrichment, you’ll end up missing those.</p>
<p>Ah, and don’t forget these events from IPv4 addresses with port (20.30.40</p>
\[.\]<p>50:12345) … you don’t want to miss those either.</p>

<h3 class="relative group">Okay, UAL is Crap. Now What? 
    <div id="okay-ual-is-crap-nowwhat" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#okay-ual-is-crap-nowwhat" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Despite everything, and because of everything, the UAL still remains honestly the best source of information you can have when investigating BECs. Assuming:</p>
<ul>
<li>They are enabled (look at this post from NathanMcNulty on his website: <a
  href="https://blog.nathanmcnulty.com/azure-automation-advanced-auditing/"
    target="_blank"
  >https://blog.nathanmcnulty.com/azure-automation-advanced-auditing/</a>)</li>
<li>The proper auditing configuration is in place (refer to Nathan’s blog post above as well and/or his tweets)</li>
<li>You’re ready to spend a̶ ̶h̶u̶g̶e̶ ̶a̶m̶o̶u̶n̶t̶ ̶o̶f̶ ̶t̶i̶m̶e̶ small amount of time parsing it, enriching it and reviewing it</li>
</ul>
<p>For everything else, or if you don’t have the time nor resources to do the above, the best combo you can use right now is the Microsoft-Extractor-Suite from <a
  href="https://medium.com/u/e992e39417b7"
    target="_blank"
  >Invictus Incident Response</a>.</p>
<p><a
  href="https://github.com/invictus-ir/Microsoft-Extractor-Suite"title="https://github.com/invictus-ir/Microsoft-Extractor-Suite"
    target="_blank"
  ><strong>GitHub - invictus-ir/Microsoft-Extractor-Suite: A PowerShell module for acquisition of data from…</strong><br>
_A PowerShell module for acquisition of data from Microsoft 365 and Azure for Incident Response and Cyber Security…_github.com</a><a
  href="https://github.com/invictus-ir/Microsoft-Extractor-Suite"
    target="_blank"
  ></a></p>
<p>And the Microsoft-Analyzer-Suite (which uses MES UAL output) from evil3ad79 (<a
  href="https://x.com/Evild3ad79"
    target="_blank"
  >https://x.com/Evild3ad79</a>):</p>
<p><a
  href="https://github.com/evild3ad/Microsoft-Analyzer-Suite"title="https://github.com/evild3ad/Microsoft-Analyzer-Suite"
    target="_blank"
  ><strong>GitHub - evild3ad/Microsoft-Analyzer-Suite: A collection of PowerShell scripts for analyzing data…</strong><br>
_A collection of PowerShell scripts for analyzing data from Microsoft 365 and Microsoft Entra ID …_github.com</a><a
  href="https://github.com/evild3ad/Microsoft-Analyzer-Suite"
    target="_blank"
  ></a></p>
<p>If you are a SMB, an organization with little to no resources for dealing with BEC or even an Analyst with not a lot of time to pour into investigating this, the MES and MAS combo can basically save you a whole lot of time.</p>
<p>Obviously, if your investigations requires more analysis in order to fully identify and understand what happen, you’ll still have to dig into the UAL, it can’t be avoided.</p>

<h3 class="relative group">/Rant 
    <div id="rant" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#rant" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>And that’s the end of my rant for tonight. Special thanks to DylanInfoSec (<a
  href="https://x.com/DylanInfosec"
    target="_blank"
  >https://x.com/DylanInfosec</a>) who actually pushed me to write this blog post. Give him a follow, alongside everyone else I tagged and/or mentioned in this post. They’re all awesome human beings, amazing at what they do and I promise you’ll learn so much from their posts it’s crazy.</p>
<p><a
  href="https://x.com/DylanInfosec/status/1868848348876448043"
    target="_blank"
  >https://x.com/DylanInfosec/status/1868848348876448043</a></p>
<p>Joking aside for a moment, I wouldn’t be able to investigate BECs properly without the UAL and I learn something new about them every single time. So if you have the time and curiosity, I highly suggest you start digging into the UAL and do research of your own. The more UALs you go through, the better you’ll get at reviewing them and the faster you’ll become as well. As with pretty much everything in life I guess. Grunt work is best work!</p>
<p>PS: I may be doing more blog posts about the UAL in the future so … stay tuned?</p>

          
          
          
        </div>
        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_Posts/1754936825269-Microsoft-Unified-Audit-Log-(UAL):-What-You-Come-To-Learn-The-Hard-Way/index.md"
          data-oid-likes="likes_Posts/1754936825269-Microsoft-Unified-Audit-Log-(UAL):-What-You-Come-To-Learn-The-Hard-Way/index.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/@securityaura/data-exfiltration-questions-and-how-to-answer-them-84856b14003c/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Data Exfiltration: Questions and How to Answer Them</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-09-15T18:22:40&#43;00:00">15 September 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/@securityaura/looking-back-on-100daysofkql-bf526b3d214e/">
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Looking Back On #100DaysOfKQL</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-05-17T18:39:45&#43;00:00">17 May 2025</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10">
  <a
    href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
      
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
        <ul class="flex list-none flex-row">
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ltr:mr-4 rtl:ml-4">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          SecurityAura
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://192.168.50.40:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
